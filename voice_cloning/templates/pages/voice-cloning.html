{% extends 'base.html' %}
{% load static %}

{% block title %}
  Voice Cloning
{% endblock %}

{% block extra_css %}
  <style>
    #upload_btn {
      cursor: pointer;
      font-size: 1.1rem;
    }
    
    input[type='range'] {
      width: 100%;
      cursor: pointer;
      border-radius: 1.3px;
    }
  </style>
{% endblock %}

{% block extra_js %}
  <script>
    function changeInput(event, div = 1, float = false) {
      let value = event.target.value * div;
      let label = event.target.parentElement.querySelector('label');
      label.innerText = float ? value.toFixed(1) : value;
    }
  </script>
{% endblock %}

{% block content %}
  <div class="container-fluid p-3" style="background-color: #f9f9f9;">
    <h2 class="p-4">
      <img src="{% static 'imgs/voice_clone.jpg' %}" alt="" width="50px" />
      Voice Clone
    </h2>
    <div class="p-4">
      <form action="handle_voice" method="POST">
        {% csrf_token %}
        <div class="form-group">
          <div class="card" style="height: 400px;">
            <div class="card-body d-flex justify-content-center align-items-center">
              <label for="voice" id="upload_btn" class="d-block text-center">
                <i class="bi bi-upload"></i>
                <p>
                  Drop Audio Here <br />-or- <br /> Click to Upload
                </p>
              </label>
              {{ form.voice }}
            </div>
          </div>
        </div>

        <div class="form-group mt-2">
          <div class="card" style="height:auto">
            <div class="card-body mb-3 border-bottom">
              <label for="" class="bg-secondary-subtle px-3 float-end">0</label>
              <label for="">Diffusion Steps</label> <br />
              <small class="text-secondary">
                Theoretically, higher should be better quality, but we cannot notice a difference <br />
                Try with lower steps first - it is faster
              </small>
              {{ form.diffusion }}
            </div>

            <div class="card-body mb-3 border-bottom">
              <label for="" class="bg-secondary-subtle px-3 float-end">0</label>
              <label for="">Embedding Scale (READ WARNING BELOW)</label> <br />
              <small class="text-secondary">Defaults to 1. WARNING: if you set this too high, and generate text that's too short you will get static.</small>
              {{ form.embedding_scale }}
            </div>
            <div class="card-body mb-3 border-bottom">
              <label for="" class="bg-secondary-subtle px-3 float-end">0</label>
              <label for="">Alpha</label> <br />
              <small class="text-secondary">Defaults to 0.3</small>
              {{ form.alpha }}
            </div>
            <div class="card-body mb-3">
              <label for="" class="bg-secondary-subtle px-3 float-end">0</label>
              <label for="">Beta</label> <br />
              <small class="text-secondary">Defaults to 0.7</small>
              {{ form.beta }}
            </div>
          </div>
        </div>
        <button class="btn btn-primary float-end mt-2" type="submit"><i class="bi bi-send"></i> Generate</button>
      </form>
    </div>
  </div>
{% endblock %}
